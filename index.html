<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>Locations Map</title>
    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css" />
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      rel="preconnect"
      href="https://fonts.gstatic.com"
      crossorigin
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Register Service Worker for caching CDN assets -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", function () {
          navigator.serviceWorker
            .register("service-worker.js")
            .then(function (registration) {
              console.log(
                "Service Worker registered with scope:",
                registration.scope
              );
            })
            .catch(function (err) {
              console.log("Service Worker registration failed:", err);
            });
        });
      }
    </script>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  </head>
  <body>
    <div class="app-overlay">
      <header class="app-header">
        <div class="app-header-left">
          <div>
            <div class="app-title">EchoRP Crime Map</div>
            <div class="app-subtitle">Interactive locations &amp; markers</div>
          </div>
        </div>
        <div class="app-header-right">
          <button id="options-toggle" class="header-button">
            <svg
              class="header-icon"
              viewBox="0 0 24 24"
              aria-hidden="true"
            >
              <path
                d="M10 6h10M4 6h2m4 6h10M4 12h6m4 6h6M4 18h8"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span>Options</span>
          </button>
        </div>
      </header>

    <!-- Sidebar for the locations list -->
    <div id="locations-list" class="locations-list">
      <div class="locations-search">
        <svg
          class="locations-search-icon"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            d="M11 5a6 6 0 1 1 0 12 6 6 0 0 1 0-12zm0-2a8 8 0 1 0 4.9 14.3l3.9 3.9a1 1 0 0 0 1.4-1.4l-3.9-3.9A8 8 0 0 0 11 3z"
            fill="currentColor"
          />
        </svg>
        <input
          id="location-search"
          type="text"
          placeholder="Search..."
          autocomplete="off"
        />
      </div>
      <div id="search-results" class="search-results"></div>
      <div id="locations-list-inner"></div>
    </div>

    <!-- Map container -->
    <div id="map"></div>

    <!-- Options container (if needed) -->
    <div id="options-container" class="hidden">
      <button id="export-button" class="popup-button">Export</button>
      <button id="import-button" class="popup-button">Import</button>
      <input
        id="import-file"
        class="popup-input"
        type="file"
        accept="application/json"
      />
      <button id="toggle-set-locations-button" class="popup-button">
        Crime Locations
      </button>
      <button id="create-marker-button" class="popup-button">
        Create Marker
      </button>
      <button id="close-options-button" class="popup-button">Close</button>
    </div>

    <!-- Modal container for enlarged images -->
    <div id="image-modal" class="modal">
      <span class="modal-close">&times;</span>
      <img class="modal-content" id="modal-image" alt="Enlarged image" />
    </div>

    <!-- Bench Recipes Modal (if needed) -->
    <div id="benchModal" class="modal">
      <div class="modal-content bench-modal-content">
        <span id="benchModalClose" class="modal-close">&times;</span>
        <div id="benchModalContent"></div>
      </div>
    </div>

    <!-- Side Popup for location details -->
    <div id="side-popup" class="side-popup">
      <span id="side-popup-close" class="side-popup-close">&times;</span>
      <div id="side-popup-content"></div>
    </div>

    <!-- Loading indicator for prefetching images -->
    <div id="loading-indicator" class="loading-indicator"></div>

    </div>
    <!-- Include the main JS file -->
    <script src="map.js"></script>
  </body>
</html>
